import{j as r}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.CQ95-tCy.js";function E({data:e,basePath:t=""}){return r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:e.files.map(i=>r.jsx(R,{basePath:t,file:i},i.key))})}function R({file:e,basePath:t}){const i=(()=>{switch(e.type){case"aseprite":case"atlas":return r.jsx(S,{atlasURL:j({path:e.atlasURL,basePath:t}),textureURL:j({path:e.textureURL,basePath:t})});case"image":return r.jsx(W,{url:j({path:e.url,basePath:t})});case"spritesheet":return r.jsx(C,{url:j({path:e.url,basePath:t}),frameConfig:e.frameConfig});default:return null}})();return r.jsxs("div",{children:[r.jsx("h3",{children:e.key}),i]})}function S({atlasURL:e,textureURL:t}){const[i,m]=o.useState(null),[{animations:n,sprites:a},u]=o.useState(()=>({animations:[],sprites:[]}));return o.useEffect(()=>{const s=new window.Image;s.onload=()=>{m(s)},s.src=t},[t]),o.useEffect(()=>{i&&(async()=>{const s=await(await fetch(e)).json(),l=new Set,c=s.meta.frameTags?.map(f=>{const h=Array.from({length:f.to+1-f.from},(x,p)=>{const d=`${f.from+p}`;return l.add(d),s.frames[d]});return{name:f.name,frames:h,texture:i}})??[],g=Object.entries(s.frames).reduce((f,[h,x])=>(l.has(h)||f.push({...x,texture:i,name:x.name??h}),f),new Array);u({animations:c,sprites:g})})()},[e,i]),r.jsxs("div",{style:{display:"flex",gap:"1rem",flexDirection:"column"},children:[!!a.length&&r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[r.jsx("h4",{children:"Sprites"}),r.jsx("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"stretch",justifyContent:"stretch",justifyItems:"stretch",alignContent:"stretch"},children:a.map(s=>r.jsx(I,{...s},s.name))})]}),!!n.length&&r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[r.jsx("h4",{children:"Animations"}),r.jsx("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",justifyItems:"stretch"},children:n?.map(s=>r.jsx(v,{...s},s.name))})]})]})}function W({url:e}){return r.jsx("img",{src:e,alt:e})}function v({name:e,frames:t,texture:i}){const m=o.useRef(null),n=o.useRef(!1),a=o.useRef(0),u=o.useRef(null);return o.useEffect(()=>{n.current=!0;const s=()=>{if(!t.length)return;const l=m.current?.getContext("2d");if(!l||!n.current)return;const c=t[a.current];l.clearRect(0,0,c.frame.w,c.frame.h),l.drawImage(i,c.frame.x,c.frame.y,c.frame.w,c.frame.h,0,0,c.frame.w,c.frame.h),t.length>1&&(a.current=(a.current+1)%t.length,u.current=setTimeout(s,c.duration))};return s(),()=>{n.current=!1,u.current&&clearTimeout(u.current)}}),t.length?r.jsx(k,{title:e,children:r.jsx("canvas",{ref:m,title:e,width:t[0].frame.w,height:t[0].frame.h,style:{imageRendering:"pixelated",display:"block",background:"none"}})}):null}function I({name:e,frame:t,texture:i}){return r.jsx(v,{name:e,frames:[{frame:t}],texture:i})}function C({frameConfig:e,url:t}){const[{sprites:i},m]=o.useState(()=>({sprites:[]}));return o.useEffect(()=>{const n=new window.Image;n.onload=()=>{const{frameWidth:a,frameHeight:u,margin:s=0,spacing:l=0}=e,c=n.naturalWidth,g=n.naturalHeight,f=Math.floor((c-s+l)/(a+l)),h=Math.floor((g-s+l)/(u+l)),x=[];for(let p=0;p<h;p++)for(let d=0;d<f;d++){const y=s+d*(a+l),w=s+p*(u+l);y+a<=c&&w+u<=g&&x.push({name:`${p*f+d}`,frame:{x:y,y:w,w:a,h:u},texture:n})}m({sprites:x})},n.src=t},[t,e]),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[r.jsx("h4",{children:"Spritesheet"}),r.jsx("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"stretch",justifyContent:"stretch",justifyItems:"stretch",alignContent:"stretch"},children:i.map(n=>r.jsx(I,{...n},n.name))})]})}function j({path:e,basePath:t}){const i=e.startsWith("/")?e.slice(1):e;let n=`${t.endsWith("/")||t===""?t:t+"/"}${i}`;{const a="/bd-25";n.startsWith(a+"/")||(n=a+(n.startsWith("/")?"":"/")+n)}return n}function k({children:e,title:t}){return r.jsxs("div",{style:{border:"1px dotted rgb(48,54,61)",padding:"1rem",gap:"0.75rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between"},children:[r.jsx("h5",{style:{margin:0,color:"#aabbcc"},children:t}),e]})}export{E as default};
